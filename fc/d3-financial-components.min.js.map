{"version":3,"file":"d3-financial-components.min.js","sources":["..\\components\\fc.js","..\\components\\utilities\\chartLayout.js","..\\components\\utilities\\dataGenerator.js","..\\components\\utilities\\weekday.js","..\\components\\indicators\\bollingerBands.js","..\\components\\indicators\\movingAverage.js","..\\components\\indicators\\relativeStrengthIndex.js","..\\components\\scale\\financeScale.js","..\\components\\scale\\gridlines.js","..\\components\\scale\\linearScale.js","..\\components\\series\\candlestick.js","..\\components\\series\\comparison.js","..\\components\\series\\line.js","..\\components\\series\\ohlc.js","..\\components\\series\\volume.js","..\\components\\tools\\annotation.js","..\\components\\tools\\callouts.js","..\\components\\tools\\crosshairs.js","..\\components\\tools\\fibonacciFan.js","..\\components\\tools\\measure.js"],"names":[],"mappings":"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","sourcesContent":["/* globals window */\nwindow.fc = {\n    version: '0.0.0',\n    indicators: {},\n    scale: {},\n    series: {},\n    tools: {},\n    utilities: {}\n};","(function (d3, fc) {\n    'use strict';\n\n    fc.utilities.chartLayout = function () {\n\n        // Default values\n        var margin = {top: 20, right: 20, bottom: 20, left: 20},\n            width = 0,\n            height = 0;\n\n        var defaultWidth = true,\n            defaultHeight = true;\n\n        var chartLayout = function (selection) {\n            selection.each( function () {\n                var element = d3.select(this),\n                    style = getComputedStyle(this);\n\n                // Attempt to automatically size the chart to the selected element\n                if (defaultWidth === true) {\n                    // Set the width of the chart to the width of the selected element,\n                    // excluding any margins, padding or borders\n                    var paddingWidth = parseInt(style.paddingLeft, 10) + parseInt(style.paddingRight, 10);\n                    width = this.clientWidth - paddingWidth;\n\n                    // If the new width is too small, use a default width\n                    if (chartLayout.innerWidth() < 1) {\n                        width = 800 + margin.left + margin.right;\n                    }\n                }\n\n                if (defaultHeight === true) {\n                    // Set the height of the chart to the height of the selected element,\n                    // excluding any margins, padding or borders\n                    var paddingHeight = parseInt(style.paddingTop, 10) + parseInt(style.paddingBottom, 10);\n                    height = this.clientHeight - paddingHeight;\n\n                    // If the new height is too small, use a default height\n                    if (chartLayout.innerHeight() < 1) {\n                        height = 400 + margin.top + margin.bottom;\n                    }\n                }\n\n                // Create svg\n                var svg = element.append('svg')\n                    .attr('width', width)\n                    .attr('height', height);\n\n                // Create group for the chart\n                var chart =  svg.append('g')\n                    .attr('class', 'chartArea')\n                    .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n                // Clipping path\n                chart.append('defs').append('clipPath')\n                    .attr('id', 'plotAreaClip')\n                    .append('rect')\n                    .attr({ width: chartLayout.innerWidth(), height: chartLayout.innerHeight() });\n\n                // create a background element\n                chart.append('rect')\n                    .attr('class', 'background')\n                    .attr('width', chartLayout.innerWidth())\n                    .attr('height', chartLayout.innerHeight());\n\n                // Create plot area, using the clipping path\n                chart.append('g')\n                    .attr('clip-path', 'url(#plotAreaClip)')\n                    .attr('class', 'plotArea');\n\n                // create containers for the axes\n                chart.append('g')\n                    .attr('class', 'axis bottom')\n                    .attr('transform', 'translate(0,' + chartLayout.innerHeight() + ')');\n                chart.append('g')\n                    .attr('class', 'axis top')\n                    .attr('transform', 'translate(0, 0)');\n                chart.append('g')\n                    .attr('class', 'axis left')\n                    .attr('transform', 'translate(0, 0)');\n                chart.append('g')\n                    .attr('class', 'axis right')\n                    .attr('transform', 'translate(' + chartLayout.innerWidth() + ', 0)');\n                \n            });\n        };\n\n        chartLayout.marginTop = function (value) {\n            if (!arguments.length) {\n                return margin.top;\n            }\n            margin.top = value;\n            return chartLayout;\n        };\n\n        chartLayout.marginRight = function (value) {\n            if (!arguments.length) {\n                return margin.right;\n            }\n            margin.right = value;\n            return chartLayout;\n        };\n\n        chartLayout.marginBottom = function (value) {\n            if (!arguments.length) {\n                return margin.bottom;\n            }\n            margin.bottom = value;\n            return chartLayout;\n        };\n\n        chartLayout.marginLeft = function (value) {\n            if (!arguments.length) {\n                return margin.left;\n            }\n            margin.left = value;\n            return chartLayout;\n        };\n\n        chartLayout.width = function (value) {\n            if (!arguments.length) {\n                return width;\n            }\n            width = value;\n            defaultWidth = false;\n            return chartLayout;\n        };\n\n        chartLayout.height = function (value) {\n            if (!arguments.length) {\n                return height;\n            }\n            height = value;\n            defaultHeight = false;\n            return chartLayout;\n        };\n\n        chartLayout.innerWidth = function () {\n            var innerWidth = width - margin.left - margin.right;\n            return innerWidth;\n        };\n\n        chartLayout.innerHeight = function () {\n            var innerHeight = height - margin.top - margin.bottom;\n            return innerHeight;\n        };\n\n        chartLayout.getSVG = function (setupArea) {\n            return setupArea.select('svg');\n        };\n\n        chartLayout.getChartArea = function (setupArea) {\n            return chartLayout.getSVG(setupArea).select('.chartArea');\n        };\n\n        chartLayout.getPlotArea = function (setupArea) {\n            return chartLayout.getSVG(setupArea).select('.plotArea');\n        };\n\n        chartLayout.getAxisContainer = function (setupArea, orientation) {\n            return chartLayout.getSVG(setupArea).select('.axis.' + orientation);\n        };\n\n        chartLayout.getPlotAreaBackground = function (setupArea) {\n            return chartLayout.getSVG(setupArea).select('.chartArea rect.background');\n        };\n\n        return chartLayout;\n    };\n\n    \n}(d3, fc));","(function (fc) {\n    'use strict';\n\n    fc.utilities.dataGenerator = function () {\n\n        var mu = 0.1,\n            sigma = 0.1,\n            startingPrice = 100,\n            startingVolume = 100000,\n            intraDaySteps = 50,\n            volumeNoiseFactor = 0.3,\n            toDate = new Date(),\n            fromDate = new Date(),\n            useFakeBoxMuller = false,\n            filter = function (date) {\n                return !(date.getDay() === 0 || date.getDay() === 6);\n            };\n\n        var generatePrices = function (period, steps) {\n            var increments = generateIncrements(period, steps, mu, sigma),\n                i, prices = [];\n            prices[0] = startingPrice;\n\n            for (i = 1; i < increments.length; i += 1) {\n                prices[i] = prices[i - 1] * increments[i];\n            }\n            return prices;\n        };\n\n        var generateVolumes = function (period, steps) {\n            var increments = generateIncrements(period, steps, 0, 1),\n                i, volumes = [];\n\n            volumeNoiseFactor = Math.max(0, Math.min(volumeNoiseFactor, 1));\n            volumes[0] = startingVolume;\n\n            for (i = 1; i < increments.length; i += 1) {\n                volumes[i] = volumes[i - 1] * increments[i];\n            }\n            volumes = volumes.map(function (vol) {\n                return Math.floor(vol * (1 - volumeNoiseFactor + Math.random() * volumeNoiseFactor * 2));\n            });\n            return volumes;\n        };\n\n        var generateIncrements = function (period, steps, mu, sigma) {\n            var deltaW = [],\n                deltaY = period / steps,\n                sqrtDeltaY = Math.sqrt(deltaY);\n\n            for(var i=0; i<steps; i++ ) {\n                var r = useFakeBoxMuller ?\n                    fakeBoxMullerTransform() :\n                    boxMullerTransform()[0];\n                r *= sqrtDeltaY;\n                r *= sigma;\n                r += (mu - ((sigma * sigma) / 2)) * deltaY;\n                deltaW.push(Math.exp(r));\n            }\n            return deltaW;\n        };\n\n        var boxMullerTransform = function() {\n            var x = 0, y = 0, rds, c;\n\n            // Get two random numbers from -1 to 1.\n            // If the radius is zero or greater than 1, throw them out and pick two new ones\n            do {\n                x = Math.random()*2-1;\n                y = Math.random()*2-1;\n                rds = x*x + y*y;\n            }\n            while (rds === 0 || rds > 1);\n\n            // This is the Box-Muller Transform\n            c = Math.sqrt(-2*Math.log(rds)/rds);\n\n            // It always creates a pair of numbers but it is quite efficient so don't be afraid to throw one away if you don't need both.\n            return [x*c, y*c];\n        };\n\n        var fakeBoxMullerTransform = function() {\n            return (Math.random()*2-1)+(Math.random()*2-1)+(Math.random()*2-1);\n        };\n\n        var generate = function() {\n\n            var msec_per_year = 3.15569e10,\n                rangeYears = (toDate.getTime() - fromDate.getTime()) / msec_per_year,\n                daysIncluded = 0,\n                prices,\n                volume,\n                ohlcv = [],\n                daySteps,\n                currentStep = 0,\n                currentIntraStep = 0;\n\n            var date = new Date(fromDate.getTime());\n            while (date <= toDate) {\n                if (!filter || filter(date)) {\n                    daysIncluded += 1;\n                }\n                date.setDate(date.getDate()+1);\n            }\n\n            prices = generatePrices(rangeYears, daysIncluded * intraDaySteps);\n            volume = generateVolumes(rangeYears, daysIncluded);\n\n            date = new Date(fromDate.getTime());\n            while(date <= toDate) {\n                if (!filter || filter(date)) {\n                    daySteps = prices.slice(currentIntraStep, currentIntraStep + intraDaySteps);\n                    ohlcv.push({\n                        date: new Date(date.getTime()),\n                        open: daySteps[0],\n                        high: Math.max.apply({}, daySteps),\n                        low: Math.min.apply({}, daySteps),\n                        close: daySteps[intraDaySteps - 1],\n                        volume: volume[currentStep]\n                    });\n                    currentIntraStep += intraDaySteps;\n                    currentStep += 1;\n                }\n                date.setDate(date.getDate()+1);\n            }\n\n            return ohlcv;\n        };\n\n        var dataGenerator = function (selection) {\n        };\n\n        dataGenerator.generate = function() {\n            return generate();\n        };\n\n        dataGenerator.mu = function (value) {\n            if (!arguments.length) {\n                return mu;\n            }\n            mu = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.sigma = function (value) {\n            if (!arguments.length) {\n                return sigma;\n            }\n            sigma = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.startingPrice = function (value) {\n            if (!arguments.length) {\n                return startingPrice;\n            }\n            startingPrice = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.startingVolume = function (value) {\n            if (!arguments.length) {\n                return startingVolume;\n            }\n            startingVolume = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.intraDaySteps = function (value) {\n            if (!arguments.length) {\n                return intraDaySteps;\n            }\n            intraDaySteps = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.volumeNoiseFactor = function (value) {\n            if (!arguments.length) {\n                return volumeNoiseFactor;\n            }\n            volumeNoiseFactor = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.filter = function (value) {\n            if (!arguments.length) {\n                return filter;\n            }\n            filter = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.toDate = function (value) {\n            if (!arguments.length) {\n                return toDate;\n            }\n            toDate = value;\n            return dataGenerator;\n        };\n\n        dataGenerator.fromDate = function (value) {\n            if (!arguments.length) {\n                return fromDate;\n            }\n            fromDate = value;\n            return dataGenerator;\n        };\n\n        return dataGenerator;\n    };\n}(fc));","(function(d3, fc) {\n    'use strict';\n\n    var weekdayCache = {};\n    var dateCache = {};\n\n    // Returns the weekday number for the given date relative to January 1, 1970.\n    function weekday(date) {\n\n        if (date in weekdayCache) {\n            return weekdayCache[date];\n        }\n\n        var weekdays = weekdayOfYear(date),\n            year = date.getFullYear();\n\n        while (--year >= 1970) {\n            weekdays += weekdaysInYear(year);\n        }\n\n        weekdayCache[date] = weekdays;\n        return weekdays;\n    }\n\n    // Returns the date for the specified weekday number relative to January 1, 1970.\n    weekday.invert = function(weekdays) {\n        if (weekdays in dateCache) {\n            return dateCache[weekdays];\n        }\n        var year = 1970,\n            yearWeekdays,\n            result;\n\n        // Compute the year.\n        while ((yearWeekdays = weekdaysInYear(year)) <= weekdays) {\n            ++year;\n            weekdays -= yearWeekdays;\n        }\n\n        // Compute the date from the remaining weekdays.\n        var days = weekdays % 5,\n            day0 = ((new Date(year, 0, 1)).getDay() + 6) % 7;\n        if (day0 + days > 4) {\n            days += 2;\n        }\n\n        result = new Date(year, 0, (weekdays / 5 | 0) * 7 + days + 1);\n        dateCache[weekdays] = result;\n        return result;\n    };\n\n    // Returns the number of weekdays in the specified year.\n    function weekdaysInYear(year) {\n        return weekdayOfYear(new Date(year, 11, 31)) + 1;\n    }\n\n    // Returns the weekday number for the given date relative to the start of the year.\n    function weekdayOfYear(date) {\n        var days = d3.time.dayOfYear(date),\n            weeks = days / 7 | 0,\n            day0 = (d3.time.year(date).getDay() + 6) % 7,\n            day1 = day0 + days - weeks * 7;\n        return Math.max(0, days - weeks * 2 -\n            (day0 <= 5 && day1 >= 5 || day0 <= 12 && day1 >= 12) - // extra saturday\n            (day0 <= 6 && day1 >= 6 || day0 <= 13 && day1 >= 13)); // extra sunday\n    }\n\n    fc.utilities.weekday = weekday;\n\n}(d3, fc));\n","(function (d3, fc) {\n\t'use strict';\n\n\tfc.indicators.bollingerBands = function () {\n\n\t\tvar xScale = d3.time.scale(),\n\t\t\tyScale = d3.scale.linear();\n\n\t\tvar yValue = function(d) { return d.close; },\n\t\t\tmovingAverage = 20,\n\t\t\tstandardDeviations = 2;\n\n\t\tvar cssBandArea = 'bollingerBandArea',\n\t\t\tcssBandUpper = 'bollingerBandUpper',\n\t\t\tcssBandLower = 'bollingerBandLower',\n\t\t\tcssAverage = 'bollingerAverage';\n\n\t\tvar bollingerBands = function (selection) {\n\n\t\t\tvar areaBands = d3.svg.area(),\n\t\t\t\tlineUpper = d3.svg.line(),\n\t\t\t\tlineLower = d3.svg.line(),\n\t\t\t\tlineAverage = d3.svg.line();\n\n\t\t\tareaBands.x(function (d) { return xScale(d.date); });\n\t\t\tlineUpper.x(function (d) { return xScale(d.date); });\n\t\t\tlineLower.x(function (d) { return xScale(d.date); });\n\t\t\tlineAverage.x(function (d) { return xScale(d.date); });\n\n\t\t\tvar calculateMovingAverage = function (data, i) {\n\n\t\t\t\tif (movingAverage === 0) {\n\t\t\t\t\treturn yValue(data[i]);\n\t\t\t\t}\n\n\t\t\t\tvar count = Math.min(movingAverage, i + 1),\n\t\t\t\tfirst = i + 1 - count;\n\n\t\t\t\tvar sum = 0;\n\t\t\t\tfor (var index = first; index <= i; ++index) {\n\t\t\t\t\tvar x = yValue(data[index]);\n\t\t\t\t\tsum += x;\n\t\t\t\t}\n\n\t\t\t\treturn sum / count;\n\t\t\t};\n\n\t\t\tvar calculateMovingStandardDeviation = function (data, i, avg) {\n\n\t\t\t\tif (movingAverage === 0) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tvar count = Math.min(movingAverage, i + 1),\n\t\t\t\t\tfirst = i + 1 - count;\n\n\t\t\t\tvar sum = 0;\n\t\t\t\tfor (var index = first; index <= i; ++index) {\n\t\t\t\t\tvar x = yValue(data[index]);\n\t\t\t\t\tvar dx = x - avg;\n\t\t\t\t\tsum += (dx * dx);\n\t\t\t\t}\n\n\t\t\t\tvar variance = sum / count;\n\t\t\t\treturn Math.sqrt(variance);\n\t\t\t};\n\n\t\t\tselection.each(function (data) {\n\n\t\t\t\tvar bollingerData = {};\n\t\t\t\tfor (var index = 0; index < data.length; ++index) {\n\n\t\t\t\t\tvar date = data[index].date;\n\n\t\t\t\t\tvar avg = calculateMovingAverage(data, index);\n\t\t\t\t\tvar sd = calculateMovingStandardDeviation(data, index, avg);\n\n\t\t\t\t\tbollingerData[date] = {avg: avg, sd: sd};\n\t\t\t\t}\n\n\t\t\t\tareaBands.y0(function (d) {\n\n\t\t\t\t\tvar avg = bollingerData[d.date].avg;\n\t\t\t\t\tvar sd = bollingerData[d.date].sd;\n\n\t\t\t\t\treturn yScale(avg + (sd * standardDeviations));\n\t\t\t\t});\n\n\t\t\t\tareaBands.y1(function (d) {\n\n\t\t\t\t\tvar avg = bollingerData[d.date].avg;\n\t\t\t\t\tvar sd = bollingerData[d.date].sd;\n\n\t\t\t\t\treturn yScale(avg - (sd * standardDeviations));\n\t\t\t\t});\n\n\t\t\t\tlineUpper.y(function (d) {\n\n\t\t\t\t\tvar avg = bollingerData[d.date].avg;\n\t\t\t\t\tvar sd = bollingerData[d.date].sd;\n\n\t\t\t\t\treturn yScale(avg + (sd * standardDeviations));\n\t\t\t\t});\n\n\t\t\t\tlineLower.y(function (d) {\n\n\t\t\t\t\tvar avg = bollingerData[d.date].avg;\n\t\t\t\t\tvar sd = bollingerData[d.date].sd;\n\n\t\t\t\t\treturn yScale(avg - (sd * standardDeviations));\n\t\t\t\t});\n\n\t\t\t\tlineAverage.y(function (d) {\n\n\t\t\t\t\tvar avg = bollingerData[d.date].avg;\n\n\t\t\t\t\treturn yScale(avg);\n\t\t\t\t});\n\n\t\t\t\tvar prunedData = [];\n\t\t\t\tfor (var n = movingAverage; n < data.length; ++n) {\n\t\t\t\t\tprunedData.push(data[n]);\n\t\t\t\t}\n\n\t\t\t\tvar pathArea = d3.select(this).selectAll('.area')\n\t\t\t\t\t.data([prunedData]);\n\t\t\t\tvar pathUpper = d3.select(this).selectAll('.upper')\n\t\t\t\t\t.data([prunedData]);\n\t\t\t\tvar pathLower = d3.select(this).selectAll('.lower')\n\t\t\t\t\t.data([prunedData]);\n\t\t\t\tvar pathAverage = d3.select(this).selectAll('.average')\n\t\t\t\t\t.data([prunedData]);\n\n\t\t\t\tpathArea.enter().append('path');\n\t\t\t\tpathUpper.enter().append('path');\n\t\t\t\tpathLower.enter().append('path');\n\t\t\t\tpathAverage.enter().append('path');\n\n\t\t\t\tpathArea.attr('d', areaBands)\n\t\t\t\t\t.classed('area', true)\n\t\t\t\t\t.classed(cssBandArea, true);\n\t\t\t\tpathUpper.attr('d', lineUpper)\n\t\t\t\t\t.classed('upper', true)\n\t\t\t\t\t.classed(cssBandUpper, true);\n\t\t\t\tpathLower.attr('d', lineLower)\n\t\t\t\t\t.classed('lower', true)\n\t\t\t\t\t.classed(cssBandLower, true);\n\t\t\t\tpathAverage.attr('d', lineAverage)\n\t\t\t\t\t.classed('average', true)\n\t\t\t\t\t.classed(cssAverage, true);\n\n\t\t\t\tpathArea.exit().remove();\n\t\t\t\tpathUpper.exit().remove();\n\t\t\t\tpathLower.exit().remove();\n\t\t\t\tpathAverage.exit().remove();\n\t\t\t});\n\t\t};\n\n\t\tbollingerBands.xScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn xScale;\n\t\t\t}\n\t\t\txScale = value;\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.yScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yScale;\n\t\t\t}\n\t\t\tyScale = value;\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.yValue = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yValue;\n\t\t\t}\n\t\t\tyValue = value;\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.movingAverage = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn movingAverage;\n\t\t\t}\n\t\t\tif (value >= 0) {\n\t\t\t\tmovingAverage = value;\n\t\t\t}\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.standardDeviations = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn standardDeviations;\n\t\t\t}\n\t\t\tif (value >= 0) {\n\t\t\t\tstandardDeviations = value;\n\t\t\t}\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.cssBandUpper = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn cssBandUpper;\n\t\t\t}\n\t\t\tcssBandUpper = value;\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.cssBandLower = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn cssBandLower;\n\t\t\t}\n\t\t\tcssBandLower = value;\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.cssBandArea = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn cssBandArea;\n\t\t\t}\n\t\t\tcssBandArea = value;\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\tbollingerBands.cssAverage = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn cssAverage;\n\t\t\t}\n\t\t\tcssAverage = value;\n\t\t\treturn bollingerBands;\n\t\t};\n\n\t\treturn bollingerBands;\n\t};\n}(d3, fc));\n","(function (d3, fc) {\n\t'use strict';\n\n\tfc.indicators.movingAverage = function () {\n\n\t\tvar xScale = d3.time.scale(),\n\t\t\tyScale = d3.scale.linear(),\n\t\t\tyValue = function(d) { return 0; },\n\t\t\taveragePoints = 5,\n\t\t\tcss = '';\n\n\t\tvar movingAverage = function (selection) {\n\t\t\tvar line = d3.svg.line();\n\t\t\tline.x(function (d) { return xScale(d.date); });\n\n\t\t\tselection.each(function (data) {\n\n                if (averagePoints === 0) {\n                    line.y(function (d) { return yScale(yValue(d)); });\n                }\n                else {\n                    line.y(function (d, i) {\n                        var count = Math.min(averagePoints, i + 1),\n                            first = i + 1 - count;\n\n                        var sum = 0;\n                        for (var index = first; index <= i; ++index) {\n                            sum += yValue(data[index]);\n                        }\n                        var mean = sum / count;\n\n                        return yScale(mean);\n                    });\n                }\n\n\t\t\t\tvar path = d3.select(this).selectAll('.indicator')\n\t\t\t\t\t.data([data]);\n\n\t\t\t\tpath.enter().append('path');\n\n\t\t\t\tpath.attr('d', line)\n\t\t\t\t\t.classed('indicator', true)\n\t\t\t\t\t.classed(css, true);\n\n\t\t\t\tpath.exit().remove();\n\t\t\t});\n\t\t};\n\n\t\tmovingAverage.xScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn xScale;\n\t\t\t}\n\t\t\txScale = value;\n\t\t\treturn movingAverage;\n\t\t};\n\n\t\tmovingAverage.yScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yScale;\n\t\t\t}\n\t\t\tyScale = value;\n\t\t\treturn movingAverage;\n\t\t};\n\n\t\tmovingAverage.yValue = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yValue;\n\t\t\t}\n\t\t\tyValue = value;\n\t\t\treturn movingAverage;\n\t\t};\n\n\t\tmovingAverage.averagePoints = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn averagePoints;\n\t\t\t}\n\t\t\tif (value >= 0) {\n\t\t\taveragePoints = value;\n\t\t\t}\n\t\t\treturn movingAverage;\n\t\t};\n\n\t\tmovingAverage.css = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn css;\n\t\t\t}\n\t\t\tcss = value;\n\t\t\treturn movingAverage;\n\t\t};\n\n\t\treturn movingAverage;\n\t};\n}(d3, fc));\n","(function (d3, fc) {\n\t'use strict';\n\n\tfc.indicators.rsi = function () {\n\n\t\tvar xScale = d3.time.scale(),\n\t\t\tyScale = d3.scale.linear(),\n\t\t\tsamplePeriods = 14,\n\t\t\tupperMarker = 70,\n\t\t\tlowerMarker = 30,\n\t\t\tlambda = 1.0,\n\t\t\tcss = '',\n            yValue = function(d) { return d.close; };\n\n\t\tvar upper = null,\n\t\t\tcentre = null,\n\t\t\tlower = null;\n\n\t\tvar rsi = function (selection) {\n\n\t\t\tselection.selectAll('.marker').remove();\n\n\t\t\tupper = selection.append(\"line\")\n\t\t\t\t.attr('class', 'marker upper')\n\t\t\t\t.attr('x1', xScale.range()[0]) \n\t\t\t\t.attr('y1', yScale(upperMarker))\n\t\t\t\t.attr('x2', xScale.range()[1]) \n\t\t\t\t.attr('y2', yScale(upperMarker));\n\n\t\t\tcentre = selection.append('line')\n\t\t\t\t.attr('class', 'marker centre')\n\t\t\t\t.attr('x1', xScale.range()[0]) \n\t\t\t\t.attr('y1', yScale(50))\n\t\t\t\t.attr('x2', xScale.range()[1]) \n\t\t\t\t.attr('y2', yScale(50));\n\n\t\t\tlower = selection.append('line')\n\t\t\t\t.attr('class', 'marker lower')\n\t\t\t\t.attr('x1', xScale.range()[0]) \n\t\t\t\t.attr('y1', yScale(lowerMarker))\n\t\t\t\t.attr('x2', xScale.range()[1]) \n\t\t\t\t.attr('y2', yScale(lowerMarker));\n\n\t\t\tvar line = d3.svg.line();\n\t\t\tline.x(function (d) { return xScale(d.date); });\n\n\t\t\tselection.each(function (data) {\n\n\t\t\t\tif (samplePeriods === 0) {\n\t\t\t\t\tline.y(function (d) { return yScale(0); });\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tline.y(function (d, i) {\n\t\t\t\t\t\tvar from = i - samplePeriods,\n\t\t\t\t\t\t\tto = i,\n\t\t\t\t\t\t\tup = [],\n\t\t\t\t\t\t\tdown = [];\n\n\t\t\t\t\t\tif (from < 1) {\n                            from = 1;\n                        }\n\n\t\t\t\t\t\tfor( var offset = to; offset >= from; offset--) {\n\t\t\t\t\t\t\tvar dnow = data[offset],\n\t\t\t\t\t\t\tdprev = data[offset-1];\n\n\t\t\t\t\t\t\tvar weight = Math.pow(lambda, offset);\n\t\t\t\t\t\t\tup.push(yValue(dnow) > yValue(dprev) ? (yValue(dnow) - yValue(dprev)) * weight : 0);\n\t\t\t\t\t\t\tdown.push(yValue(dnow) < yValue(dprev) ? (yValue(dprev) - yValue(dnow)) * weight : 0);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (up.length <= 0 || down.length <= 0) {\n                            return yScale(0);\n                        }\n\n\t\t\t\t\t\tvar rsi = 100 - (100/(1+(d3.mean(up)/d3.mean(down))));\n\t\t\t\t\t\treturn yScale(rsi);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar path = d3.select(this).selectAll('.rsi')\n\t\t\t\t\t.data([data]);\n\n\t\t\t\tpath.enter().append('path');\n\n\t\t\t\tpath.attr('d', line)\n\t\t\t\t\t.classed('rsi', true)\n\t\t\t\t\t.classed(css, true);\n\n\t\t\t\tpath.exit().remove();\n\t\t\t});\n\t\t};\n\n\t\trsi.xScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn xScale;\n\t\t\t}\n\t\t\txScale = value;\n\t\t\treturn rsi;\n\t\t};\n\n\t\trsi.yScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yScale;\n\t\t\t}\n\t\t\tyScale = value;\n\t\t\treturn rsi;\n\t\t};\n\n\t\trsi.samplePeriods = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn samplePeriods;\n\t\t\t}\n\t\t\tsamplePeriods = value < 0 ? 0 : value;\n\t\t\treturn rsi;\n\t\t};\n\n\t\trsi.upperMarker = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn upperMarker;\n\t\t\t}\n\t\t\tupperMarker = value > 100 ? 100 : (value < 0 ? 0 : value);\n\t\t\treturn rsi;\n\t\t};\n\n\t\trsi.lowerMarker = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn lowerMarker;\n\t\t\t}\n\t\t\tlowerMarker = value > 100 ? 100 : (value < 0 ? 0 : value);\n\t\t\treturn rsi;\n\t\t};\n\n\t\trsi.lambda = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn lambda;\n\t\t\t}\n\t\t\tlambda = value > 1.0 ? 1.0 : (value < 0.0 ? 0.0 : value);\n\t\t\treturn rsi;\n\t\t};\n\n\t\trsi.css = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn css;\n\t\t\t}\n\t\t\tcss = value;\n\t\t\treturn rsi;\n\t\t};\n\n        rsi.yValue = function (value) {\n            if (!arguments.length) {\n                return yValue;\n            }\n            yValue = value;\n            return rsi;\n        };\n\n\t\treturn rsi;\n\t};\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\n    var weekday = fc.utilities.weekday;\n\n    fc.scale.finance = function () {\n        return financialScale();\n    };\n\n    function financialScale(linear) {\n\n    \tvar alignPixels = true;\n\n        if (!arguments.length) {\n            linear = d3.scale.linear();\n        }\n\n        function scale(x) {\n            var n = 0;\n            if (typeof x === 'number') {\n                // When scaling ticks.\n                n = linear(x);\n            } else {\n                // When scaling dates.\n                n = linear(weekday(x));\n            }\n        \tvar m = Math.round(n);\n            return alignPixels ? (n > m ? m + 0.5 : m - 0.5) : n;\n        }\n\n        scale.copy = function () {\n            return financialScale(linear.copy());\n        };\n\n        scale.domain = function (domain) {\n            if (!arguments.length) {\n                return linear.domain().map(weekday.invert);\n            }\n            if (typeof domain[0] === 'number') {\n                linear.domain(domain);\n            } else {\n                linear.domain(domain.map(weekday));\n            }\n            return scale;\n        };\n\n        scale.ticks = function (n) {\n            return arguments.length ? linear.ticks(n) : linear.ticks();\n        };\n\n        scale.tickFormat = function (count, f) {\n            return function(n) {\n                var date = weekday.invert(n);\n                return d3.time.format('%b %e')(date);\n            };\n        };\n\n        scale.invert = function (pixel) {\n            return weekday.invert(linear.invert(pixel));\n        };\n\n        scale.alignPixels = function (value) {\n            if (!arguments.length) {\n                return alignPixels;\n            }\n            alignPixels = value;\n            return scale;\n        };\n\n        return d3.rebind(scale, linear, \"range\", \"rangeRound\", \"interpolate\", \"clamp\", \"nice\");\n    }\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\n    fc.scale.gridlines = function () {\n\n        var xScale = d3.time.scale(),\n            yScale = d3.scale.linear(),\n            xTicks = 10,\n            yTicks = 10;\n\n        var xLines = function (data, grid) {\n            var xlines = grid.selectAll('.x')\n                .data(data);\n            xlines\n                .enter().append('line')\n                .attr({\n                    'class': 'x',\n                    'x1': function(d) { return xScale(d);},\n                    'x2': function(d) { return xScale(d);},\n                    'y1': yScale.range()[0],\n                    'y2': yScale.range()[1]\n                });\n            xlines\n                .attr({\n                    'x1': function(d) { return xScale(d);},\n                    'x2': function(d) { return xScale(d);},\n                    'y1': yScale.range()[0],\n                    'y2': yScale.range()[1]\n                });\n            xlines.exit().remove();\n        };\n\n        var yLines = function (data, grid) {\n            var ylines = grid.selectAll('.y')\n                .data(data);\n            ylines\n                .enter().append('line')\n                .attr({\n                    'class': 'y',\n                    'x1': xScale.range()[0],\n                    'x2': xScale.range()[1],\n                    'y1': function(d) { return yScale(d);},\n                    'y2': function(d) { return yScale(d);}\n                });\n            ylines\n                .attr({\n                    'x1': xScale.range()[0],\n                    'x2': xScale.range()[1],\n                    'y1': function(d) { return yScale(d);},\n                    'y2': function(d) { return yScale(d);}\n                });\n            ylines.exit().remove();\n        };\n\n        var gridlines = function (selection) {\n            var grid, xTickData, yTickData;\n\n            selection.each(function () {\n                xTickData = xScale.ticks(xTicks);\n                yTickData = yScale.ticks(yTicks);\n\n                grid = d3.select(this).selectAll('.gridlines').data([[xTickData, yTickData]]);\n                grid.enter().append('g').classed('gridlines', true);\n                xLines(xTickData, grid);\n                yLines(yTickData, grid);\n            });\n        };\n\n        gridlines.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return gridlines;\n        };\n\n        gridlines.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return gridlines;\n        };\n\n        gridlines.xTicks = function (value) {\n            if (!arguments.length) {\n                return xTicks;\n            }\n            xTicks = value;\n            return gridlines;\n        };\n\n        gridlines.yTicks = function (value) {\n            if (!arguments.length) {\n                return yTicks;\n            }\n            yTicks = value;\n            return gridlines;\n        };\n\n        return gridlines;\n    };\n}(d3, fc));\n","(function (d3, fc) {\n    'use strict';\n\n    fc.scale.linear = function () {\n        return linearScale();\n    };\n\n    function linearScale(linear) {\n    \t\n    \tvar alignPixels = true;\n\n        if (!arguments.length) {\n            linear = d3.scale.linear();\n        }\n\n        function scale(x) {\n        \tvar n = linear(x);\n        \tvar m = Math.round(n);\n            return alignPixels ? (n > m ? m + 0.5 : m - 0.5) : n;\n        }\n\n        scale.copy = function () {\n            return linearScale(linear.copy());\n        };\n\n        scale.domain = function (domain) {\n            linear.domain(domain);\n            return scale;\n        };\n\n        scale.ticks = function (n) {\n            return linear.ticks(n);\n        };\n\n        scale.invert = function (pixel) {\n            return linear.invert(pixel);\n        };\n\n        scale.alignPixels = function (value) {\n            if (!arguments.length) {\n                return alignPixels;\n            }\n            alignPixels = value;\n            return scale;\n        };\n\n        return d3.rebind(scale, linear, \"range\", \"rangeRound\", \"interpolate\", \"clamp\", \"nice\");\n    }\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\n    fc.series.candlestick = function () {\n\n        var xScale = d3.time.scale(),\n            yScale = d3.scale.linear();\n\n        var yOpen = function(d) { return d.open; },\n            yHigh = function(d) { return d.high; },\n            yLow = function(d) { return d.low; },\n            yClose = function(d) { return d.close; };\n\n        var rectangleWidth = 5;\n\n        var isUpDay = function(d) {\n            return yClose(d) > yOpen(d);\n        };\n        var isDownDay = function (d) {\n            return !isUpDay(d);\n        };\n\n        var line = d3.svg.line()\n            .x(function (d) {\n                return d.x;\n            })\n            .y(function (d) {\n                return d.y;\n            });\n\n        var highLowLines = function (bars) {\n\n            var paths = bars.selectAll('.high-low-line').data(function (d) {\n                return [d];\n            });\n\n            paths.enter().append('path');\n\n            paths.classed('high-low-line', true)\n                .attr('d', function (d) {\n                    return line([\n                        { x: xScale(d.date), y: yScale(yHigh(d)) },\n                        { x: xScale(d.date), y: yScale(yLow(d)) }\n                    ]);\n                });\n        };\n\n        var rectangles = function (bars) {\n            var rect;\n\n            rect = bars.selectAll('rect').data(function (d) {\n                return [d];\n            });\n\n            rect.enter().append('rect');\n\n            rect.attr('x', function (d) {\n                return xScale(d.date) - (rectangleWidth/2.0);\n            })\n                .attr('y', function (d) {\n                    return isUpDay(d) ? yScale(yClose(d)) : yScale(yOpen(d));\n                })\n                .attr('width', rectangleWidth)\n                .attr('height', function (d) {\n                    return isUpDay(d) ?\n                        yScale(yOpen(d)) - yScale(yClose(d)) :\n                        yScale(yClose(d)) - yScale(yOpen(d));\n                });\n        };\n\n        var candlestick = function (selection) {\n            var series, bars;\n\n            selection.each(function (data) {\n                series = d3.select(this).selectAll('.candlestick-series').data([data]);\n\n                series.enter().append('g')\n                    .classed('candlestick-series', true);\n\n                bars = series.selectAll('.bar')\n                    .data(data, function (d) {\n                        return d.date;\n                    });\n\n                bars.enter()\n                    .append('g')\n                    .classed('bar', true);\n\n                bars.classed({\n                    'up-day': isUpDay,\n                    'down-day': isDownDay\n                });\n\n                highLowLines(bars);\n                rectangles(bars);\n\n                bars.exit().remove();\n\n\n            });\n        };\n\n        candlestick.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return candlestick;\n        };\n\n        candlestick.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return candlestick;\n        };\n\n        candlestick.rectangleWidth = function (value) {\n            if (!arguments.length) {\n                return rectangleWidth;\n            }\n            rectangleWidth = value;\n            return candlestick;\n        };\n\n        candlestick.yOpen = function(value) {\n            if (!arguments.length) {\n                return yOpen;\n            }\n            yOpen = value;\n            return candlestick;\n        };\n\n        candlestick.yHigh = function(value) {\n            if (!arguments.length) {\n                return yHigh;\n            }\n            yHigh = value;\n            return candlestick;\n        };\n\n        candlestick.yLow = function(value) {\n            if (!arguments.length) {\n                return yLow;\n            }\n            yLow = value;\n            return candlestick;\n        };\n\n        candlestick.yClose = function(value) {\n            if (!arguments.length) {\n                return yClose;\n            }\n            yClose = value;\n            return candlestick;\n        };\n\n        return candlestick;\n\n    };\n}(d3, fc));\n","(function (d3, fc) {\n    'use strict';\n\n    fc.series.comparison = function () {\n\n        var xScale = d3.time.scale(),\n            yScale = d3.scale.linear();\n\n        var cachedData, cachedScale;\n\n        var yScaleTransform = function (oldScale, newScale) {\n            // Compute transform for elements wrt changing yScale.\n            var oldDomain = oldScale.domain(),\n                newDomain = newScale.domain(),\n                scale = (oldDomain[1] - oldDomain[0]) / (newDomain[1] - newDomain[0]),\n                translate = scale * (oldScale.range()[1] - oldScale(newDomain[1]));\n            return {\n                translate: translate,\n                scale: scale\n            };\n        };\n\n        var findIndex = function (seriesData, date) {\n            // Find insertion point for date in seriesData.\n            var bisect = d3.bisector(\n                function (d) {\n                    return d.date;\n                }).left;\n\n            var initialIndex = bisect(seriesData, date);\n            if (initialIndex === 0) {\n                // Google finance style, calculate changes from the\n                // date one before initial date if possible, or index 0.\n                initialIndex += 1;\n            }\n            return initialIndex;\n        };\n\n        var percentageChange = function (seriesData, initialDate) {\n            // Computes the percentage change data of a series from an initial date.\n            var initialIndex = findIndex(seriesData, initialDate) - 1;\n            var initialClose = seriesData[initialIndex].close;\n\n            return seriesData.map(function (d) {\n                return {\n                    date: d.date,\n                    change: (d.close / initialClose) - 1\n                };\n            });\n        };\n\n        var rebaseChange = function (seriesData, initialDate) {\n            // Change the initial date the percentage changes should be based from.\n            var initialIndex = findIndex(seriesData, initialDate) - 1;\n            var initialChange = seriesData[initialIndex].change;\n\n            return seriesData.map(function (d) {\n                return {\n                    date: d.date,\n                    change: d.change - initialChange\n                };\n            });\n        };\n\n         var calculateYDomain = function (data, xDomain) {\n            var start, end;\n\n            data = data.map(function (series) {\n                series = series.data;\n                start = findIndex(series,xDomain[0]) - 1;\n                end = findIndex(series,xDomain[1]) + 1;\n                return series.slice(start, end);\n            });\n\n            var allPoints = data.reduce(function(prev, curr) {\n                return prev.concat(curr);\n            }, []);\n\n            if (allPoints.length) {\n                return d3.extent(allPoints, function(d) {\n                    return d.change;\n                });\n            } else {\n                return [0, 0];\n            }\n        };\n\n        var color = d3.scale.category10();\n\n        var line = d3.svg.line()\n            .interpolate(\"linear\")\n            .x(function (d) {\n                return xScale(d.date);\n            })\n            .y(function (d) {\n                return yScale(d.change);\n            });\n\n        var comparison = function (selection) {\n            var series, lines;\n\n            selection.each(function (data) {\n\n                data = data.map(function (d) {\n                    return {\n                        name: d.name,\n                        data: percentageChange(d.data, xScale.domain()[0])\n                    };\n                });\n\n                cachedData = data; // Save for rebasing.\n\n                color.domain(data.map(function (d) {\n                    return d.name;\n                }));\n\n                yScale.domain(calculateYDomain(data, xScale.domain()));\n                cachedScale = yScale.copy();\n\n                series = d3.select(this).selectAll('.comparison-series').data([data]);\n                series.enter().append('g').classed('comparison-series', true);\n\n                lines = series.selectAll('.line')\n                    .data(data, function(d) {\n                        return d.name;\n                    })\n                    .enter().append(\"path\")\n                    .attr(\"class\", function (d) {\n                        return \"line \" + \"line\" + data.indexOf(d);\n                    })\n                    .attr(\"d\", function (d) {\n                        return line(d.data);\n                    })\n                    .style(\"stroke\", function (d) {\n                        return color(d.name);\n                    });\n\n                series.selectAll('.line')\n                    .attr(\"d\", function (d) {\n                        return line(d.data);\n                    });\n            });\n        };\n\n        comparison.geometricZoom = function (selection, xTransformTranslate, xTransformScale) {\n            // Apply a transformation for each line to update its position wrt the new initial date,\n            // then apply the yScale transformation to reflect the updated yScale domain.\n\n            var initialIndex,\n                yTransform;\n\n            var lineTransform = function (initialChange) {\n                var yTransformLineTranslate = cachedScale(0) - cachedScale(initialChange);\n\n                yTransformLineTranslate *= yTransform.scale;\n                yTransformLineTranslate += yTransform.translate;\n\n                return 'translate(' + xTransformTranslate + ',' + yTransformLineTranslate + ')' +\n                    ' scale(' + xTransformScale + ',' + yTransform.scale + ')';\n            };\n\n            var domainData = cachedData.map(function (d) {\n                return {\n                    name: d.name,\n                    data: rebaseChange(d.data, xScale.domain()[0])\n                };\n            });\n\n            yScale.domain(calculateYDomain(domainData, xScale.domain()));\n            yTransform = yScaleTransform(cachedScale, yScale);\n\n            cachedData = cachedData.map(function (d) {\n                initialIndex = findIndex(d.data, xScale.domain()[0]) - 1;\n                return {\n                    name: d.name,\n                    data: d.data,\n                    transform: lineTransform(d.data[initialIndex].change)\n                };\n            });\n\n            selection.selectAll('.line')\n                .data(cachedData)\n                .attr('transform', function (d) { return d.transform; });\n        };\n\n        comparison.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return comparison;\n        };\n\n        comparison.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return comparison;\n        };\n\n        return comparison;\n    };\n}(d3, fc));","(function (d3, fc) {\n\t'use strict';\n\n\tfc.series.line = function () {\n\n\t\tvar yValue = function(d) { return d.close; },\n\t\t\txScale = fc.scale.finance(),\n\t\t\tyScale = fc.scale.linear(),\n\t\t\tunderFill = true;\n\n\t\tvar line = function (selection) {\n\n\t\t\tvar area;\n\n\t\t\tif(underFill) {\n\t\t\t\tarea = d3.svg.area()\n\t\t\t      \t.x(function(d) { return xScale(d.date); })\n\t\t\t    \t.y0(yScale(0));\n\t\t\t}\n\t\t\t\n\t\t\tvar line = d3.svg.line();\n\t\t\tline.x(function (d) { return xScale(d.date); });\n\n\t\t\tselection.each(function (data) {\n\n\t\t\t\tif(underFill) {\n\t\t\t\t\tarea.y1(function (d) { return yScale(yValue(d)); });\n\t\t\t\t\tvar areapath = d3.select(this).selectAll('.lineSeriesArea')\n\t\t\t\t\t\t.data([data]);\n\t\t\t\t\tareapath.enter()\n\t\t\t\t\t\t.append('path')\n\t\t\t\t\t\t.attr('d', area)\n\t\t\t\t\t\t.classed('lineSeriesArea', true);\n\t\t\t\t\tareapath.exit()\n\t\t\t\t\t\t.remove();\n\t\t\t\t}\n\n\t\t\t\tline.y(function (d) { return yScale(yValue(d)); });\n\t\t\t\tvar linepath = d3.select(this).selectAll('.lineSeries')\n\t\t\t\t\t.data([data]);\n\t\t\t\tlinepath.enter()\n\t\t\t\t\t.append('path')\n\t\t\t\t\t.attr('d', line)\n\t\t\t\t\t.classed('lineSeries', true);\n\t\t\t\tlinepath.exit()\n\t\t\t\t\t.remove();\n\t\t\t});\n\t\t};\n\n\t\tline.yValue = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yValue;\n\t\t\t}\n\t\t\tyValue = value;\n\t\t\treturn line;\n\t\t};\n\n\t\tline.xScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn xScale;\n\t\t\t}\n\t\t\txScale = value;\n\t\t\treturn line;\n\t\t};\n\n\t\tline.yScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yScale;\n\t\t\t}\n\t\t\tyScale = value;\n\t\t\treturn line;\n\t\t};\n\n\t\tline.underFill = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn underFill;\n\t\t\t}\n\t\t\tunderFill = value;\n\t\t\treturn line;\n\t\t};\n\n\t\treturn line;\n\t};\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\n    fc.series.ohlc = function (drawMethod) {\n\n        // Configurable attributes\n        var xScale = d3.time.scale(),\n            yScale = d3.scale.linear(),\n            tickWidth = 5;\n\n        var yOpen = function(d) { return d.open; },\n            yHigh = function(d) { return d.high; },\n            yLow = function(d) { return d.low; },\n            yClose = function(d) { return d.close; };\n\n        // Function to return\n        var ohlc;\n\n        // Accessor functions\n        var open = function (d) {\n                return yScale(yOpen(d));\n            },\n            high = function (d) {\n                return yScale(yHigh(d));\n            },\n            low = function (d) {\n                return yScale(yLow(d));\n            },\n            close = function (d) {\n                return yScale(yClose(d));\n            },\n            date = function (d) {\n                return xScale(d.date);\n            };\n\n        // Up/down day logic\n        var isUpDay = function(d) {\n            return yClose(d) > yOpen(d);\n        };\n        var isDownDay = function (d) {\n            return yClose(d) < yOpen(d);\n        };\n        var isStaticDay = function (d) {\n            return yClose(d) === yOpen(d);\n        };\n\n        var barColour = function(d) {\n            if (isUpDay(d)) {\n                return 'green';\n            } else if (isDownDay(d)) {\n                return 'red';\n            } else {\n                return 'black';\n            }\n        };\n\n        // Path drawing\n        var makeBarPath = function (d) {\n            var moveToLow = 'M' + date(d) + ',' + low(d),\n                verticalToHigh = 'V' + high(d),\n                openTick = 'M' + date(d) + \",\" + open(d) + 'h' + (-tickWidth),\n                closeTick = 'M' + date(d) + \",\" + close(d) + 'h' + tickWidth;\n            return moveToLow + verticalToHigh + openTick + closeTick;\n        };\n\n        var makeConcatPath = function (data) {\n            var path = 'M0,0';\n            data.forEach(function (d) {\n                path += makeBarPath(d);\n            });\n            return path;\n        };\n\n        // Filters data, and draws a series of ohlc bars from the result as a single path.\n        var makeConcatPathElement = function(series, elementClass, colour, data, filterFunction) {\n            var concatPath;\n            var filteredData = data.filter(function (d) {\n                return filterFunction(d);\n            });\n            concatPath = series.selectAll('.' + elementClass)\n                .data([filteredData]);\n\n            concatPath.enter()\n                .append('path')\n                .classed(elementClass, true);\n\n            concatPath\n                .attr('d', makeConcatPath(filteredData))\n                .attr('stroke', colour);\n\n\n            concatPath.exit().remove();\n        };\n\n        // Common series element\n        var makeSeriesElement = function (selection, data) {\n            var series = d3.select(selection).selectAll('.ohlc-series').data([data]);\n            series.enter().append('g').classed('ohlc-series', true);\n            return series;\n        };\n\n        // Draw ohlc bars as groups of svg lines\n        var ohlcLineGroups = function (selection) {\n            selection.each(function (data) {\n                var series = makeSeriesElement(this, data);\n\n                var bars = series.selectAll('.bar')\n                    .data(data, function (d) {\n                        return d.date;\n                    });\n\n                // Enter\n                var barEnter = bars.enter().append('g').classed('bar', true);\n                barEnter.append('line').classed('high-low-line', true);\n                barEnter.append('line').classed('open-tick', true);\n                barEnter.append('line').classed('close-tick', true);\n\n                // Update\n                bars.classed({\n                    'up-day': isUpDay,\n                    'down-day': isDownDay,\n                    'static-day': isStaticDay\n                });\n\n                bars.attr('stroke', barColour);\n\n                bars.select('.high-low-line').attr({x1: date, y1: low, x2: date, y2: high });\n                bars.select('.open-tick').attr({\n                    x1: function (d) { return date(d) - tickWidth; },\n                    y1: open,\n                    x2: date,\n                    y2: open\n                });\n                bars.select('.close-tick').attr({\n                    x1: date,\n                    y1: close,\n                    x2: function (d) { return date(d) + tickWidth; },\n                    y2: close\n                });\n\n                // Exit\n                bars.exit().remove();\n            });\n        };\n\n        // Draw ohlc bars as svg paths\n        var ohlcBarPaths = function (selection) {\n            selection.each(function (data) {\n                var series = makeSeriesElement(this, data);\n\n                var bars = series.selectAll('.bar')\n                    .data(data, function (d) {\n                        return d.date;\n                    });\n\n                bars.enter()\n                    .append('path')\n                    .classed('bar', true);\n\n                bars.classed({\n                    'up-day': isUpDay,\n                    'down-day': isDownDay,\n                    'static-day': isStaticDay\n                });\n\n                bars.attr({\n                    'stroke': barColour,\n                    'd': makeBarPath\n                });\n\n                bars.exit().remove();\n            });\n        };\n\n        // Draw the complete series of ohlc bars using 3 paths\n        var ohlcConcatBarPaths = function (selection) {\n            selection.each(function (data) {\n                var series = makeSeriesElement(this, data);\n                makeConcatPathElement(series, 'up-days', 'green', data, isUpDay);\n                makeConcatPathElement(series, 'down-days', 'red' ,data, isDownDay);\n                makeConcatPathElement(series, 'static-days', 'black', data, isStaticDay);\n            });\n        };\n\n        switch (drawMethod) {\n            case 'line': ohlc = ohlcLineGroups; break;\n            case 'path': ohlc = ohlcBarPaths; break;\n            case 'paths': ohlc = ohlcConcatBarPaths; break;\n            default: ohlc = ohlcBarPaths;\n        }\n\n        ohlc.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return ohlc;\n        };\n\n        ohlc.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return ohlc;\n        };\n\n        ohlc.tickWidth = function (value) {\n            if (!arguments.length) {\n                return tickWidth;\n            }\n            tickWidth = value;\n            return ohlc;\n        };\n\n        ohlc.yOpen = function(value) {\n            if (!arguments.length) {\n                return yOpen;\n            }\n            yOpen = value;\n            return ohlc;\n        };\n\n        ohlc.yHigh = function(value) {\n            if (!arguments.length) {\n                return yHigh;\n            }\n            yHigh = value;\n            return ohlc;\n        };\n\n        ohlc.yLow = function(value) {\n            if (!arguments.length) {\n                return yLow;\n            }\n            yLow = value;\n            return ohlc;\n        };\n\n        ohlc.yClose = function(value) {\n            if (!arguments.length) {\n                return yClose;\n            }\n            yClose = value;\n            return ohlc;\n        };\n\n        return ohlc;\n    };\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\n    fc.series.volume = function () {\n\n        var xScale = d3.time.scale(),\n            yScale = d3.scale.linear(),\n            barWidth = 5,\n            yValue = function(d) { return d.volume; };\n\n        var isUpDay = function(d) {\n            return d.close > d.open;\n        };\n        var isDownDay = function (d) {\n            return !isUpDay(d);\n        };\n\n        var rectangles = function (bars) {\n            var rect;\n\n            rect = bars.selectAll('rect').data(function (d) {\n                return [d];\n            });\n\n            rect.enter().append('rect');\n\n            rect.attr('x', function (d) { return xScale(d.date) - (barWidth/2.0); })\n                .attr('y', function(d) { return yScale(yValue(d)); } )\n                .attr('width', barWidth)\n                .attr('height', function(d) { return yScale(0) - yScale(yValue(d)); });\n        };\n\n        var volume = function (selection) {\n            var series, bars;\n\n            selection.each(function (data) {\n                series = d3.select(this).selectAll('.volume-series').data([data]);\n\n                series.enter().append('g')\n                    .classed('volume-series', true);\n\n                bars = series.selectAll('.volumebar')\n                    .data(data, function (d) {\n                        return d.date;\n                    });\n\n                bars.enter()\n                    .append('g')\n                    .classed('volumebar', true);\n\n                bars.classed({\n                    'up-day': isUpDay,\n                    'down-day': isDownDay\n                });\n                rectangles(bars);\n                bars.exit().remove();\n           });\n        };\n\n        volume.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return volume;\n        };\n\n        volume.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return volume;\n        };\n\n        volume.barWidth = function (value) {\n            if (!arguments.length) {\n                return barWidth;\n            }\n            barWidth = value;\n            return volume;\n        };\n\n        volume.yValue = function (value) {\n            if (!arguments.length) {\n                return yValue;\n            }\n            yValue = value;\n            return volume;\n        };\n\n        return volume;\n    };\n}(d3, fc));\n","(function (d3, fc) {\n    'use strict';\n\n    fc.tools.annotation = function () {\n\n        var index = 0,\n            xScale = d3.time.scale(),\n            yScale = d3.scale.linear(),\n            yLabel = '',\n            yValue = 0,\n            padding = 2,\n            formatCallout = function(d) { return d; };\n\n        var root = null,\n            line = null,\n            callout = null;\n\n        var annotation = function (selection) {\n\n            root = selection.append('g')\n                .attr('id', 'annotation_' + index)\n                .attr('class', 'annotation');\n\n            line = root.append(\"line\")\n                .attr('class', 'marker')\n                .attr('x1', xScale.range()[0]) \n                .attr('y1', yScale(yValue))\n                .attr('x2', xScale.range()[1]) \n                .attr('y2', yScale(yValue));\n\n\n            callout = root.append(\"text\")\n                .attr('class', 'callout')\n                .attr('x', xScale.range()[1] - padding)\n                .attr('y', yScale(yValue) - padding)\n                .attr('style', 'text-anchor: end;')\n                .text(yLabel + \": \" + formatCallout(yValue));\n        };\n\n        annotation.index = function (value) {\n            if (!arguments.length) {\n                return index;\n            }\n            index = value;\n            return annotation;\n        };\n\n        annotation.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return annotation;\n        };\n\n        annotation.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return annotation;\n        };\n\n        annotation.yValue = function (value) {\n            if (!arguments.length) {\n                return yValue;\n            }\n            yValue = value;\n            return annotation;\n        };\n\n        annotation.yLabel = function (value) {\n            if (!arguments.length) {\n                return yLabel;\n            }\n            yLabel = value;\n            return annotation;\n        };\n\n        annotation.padding = function (value) {\n            if (!arguments.length) {\n                return padding;\n            }\n            padding = value;\n            return annotation;\n        };\n\n        annotation.formatCallout = function (value) {\n            if (!arguments.length) {\n                return formatCallout;\n            }\n            formatCallout = value;\n            return annotation;\n        };\n\n        return annotation;\n    };\n}(d3, fc));","/*jshint loopfunc: true */\n(function (d3, fc) {\n\t\t'use strict';\n\n\t\tfc.tools.callouts = function () {\n\n\t\tvar xScale = d3.time.scale(),\n\t\t\tyScale = d3.scale.linear(),\n\t\t\tpadding = 5,\n\t\t\tspacing = 5,\n\t\t\trounded = 0,\n\t\t\trotationStart = 20,\n\t\t\trotationSteps = 20,\n\t\t\tstalkLength = 50,\n\t\t\tcss = 'callout',\n\t\t\tdata = [];\n\n\t\tvar currentBB = null,\n\t\t\tboundingBoxes = [],\n\t\t\tcurrentRotation = 0;\n\n\t\tvar rectanglesIntersect = function(r1, r2) {\n\t\t\treturn !(r2.left > r1.right || \n\t\t\t\tr2.right < r1.left || \n\t\t\t\tr2.top > r1.bottom ||\n\t\t\t\tr2.bottom < r1.top);\n\t\t};\n\n\t\tvar arrangeCallouts = function() {\n\n\t\t\tif (!boundingBoxes) {\n                return;\n            }\n\n\t\t\tvar sortedRects = boundingBoxes.sort(function(a,b) {\n\t\t\t\tif (a.y < b.y) {\n                    return -1;\n                }\n\t\t\t\tif (a.y > b.y) {\n                    return 1;\n                }\n\t\t\t\treturn 0;\n\t\t\t});\n\n\t\t\tcurrentRotation = rotationStart;\n\t\t\tfor(var i=0; i<sortedRects.length; i++) {\n\n\t\t\t\t// Calculate the x and y components of the stalk\n\t\t\t\tvar offsetX = stalkLength * Math.sin(currentRotation * (Math.PI/180));\n\t\t\t\tsortedRects[i].x += offsetX;\n\t\t\t\tvar offsetY = stalkLength * Math.cos(currentRotation * (Math.PI/180));\n\t\t\t\tsortedRects[i].y -= offsetY;\n\n\t\t\t\tcurrentRotation += rotationSteps;\n\t\t\t}\n\n\t\t\t// Tree sorting algo (Sudo code below)\n\t\t\tfor(var r1=0; r1<sortedRects.length; r1++ ){\n\t\t\t\tfor(var r2=r1+1; r2<sortedRects.length; r2++) {\n\n\t\t\t\t\tif( !sortedRects[r1].left ) {\n\t\t\t\t\t\tsortedRects[r1].left = function() { return this.x - padding; };\n\t\t\t\t\t\tsortedRects[r1].right = function() { return this.x + this.width + padding; };\n\t\t\t\t\t\tsortedRects[r1].bottom = function() { return this.y + this.height + padding; };\n\t\t\t\t\t\tsortedRects[r1].top = function() { return this.y - padding; };\n\t\t\t\t\t}\n\n\t\t\t\t\tif( !sortedRects[r2].left ) {\n\t\t\t\t\t\tsortedRects[r2].left = function() { return this.x - padding; };\n\t\t\t\t\t\tsortedRects[r2].right = function() { return this.x + this.width + padding; };\n\t\t\t\t\t\tsortedRects[r2].bottom = function() { return this.y + this.height + padding; };\n\t\t\t\t\t\tsortedRects[r2].top = function() { return this.y - padding; };\n\t\t\t\t\t}\n\n\t\t\t\t\tif(rectanglesIntersect(sortedRects[r1], sortedRects[r2])) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Find the smallest move to correct the overlap\n\t\t\t\t\t\tvar smallest = 0; // 0=left, 1=right, 2=down\n\t\t\t\t\t\tvar left = sortedRects[r2].right() - sortedRects[r1].left();\n\t\t\t\t\t\tvar right = sortedRects[r1].right() - sortedRects[r2].left();\n\t\t\t\t\t\tif (right < left) {\n                            smallest = 1;\n                        }\n\t\t\t\t\t\tvar down = sortedRects[r1].bottom() - sortedRects[r2].top();\n\t\t\t\t\t\tif (down < right && down < left) {\n                            smallest = 2;\n                        }\n\n\t\t\t\t\t\tif (smallest === 0) {\n                            sortedRects[r2].x -= (left + spacing);\n                        }\n\t\t\t\t\t\telse if (smallest === 1) {\n                            sortedRects[r2].x += (right + spacing);\n                        }\n\t\t\t\t\t\telse if (smallest === 2) {\n                            sortedRects[r2].y += (down + spacing);\n                        }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tboundingBoxes = sortedRects;\n\t\t};\n\n\t\tvar callouts = function (selection) {\n\n\t\t\t// Create the callouts\n\t\t\tvar callouts = selection.selectAll('g')\n\t\t\t\t.data(data)\n\t\t\t\t.enter()\n\t\t\t\t.append('g')\n\t\t\t\t.attr('transform', function(d) { return 'translate(' + xScale(d.x) + ',' + yScale(d.y) +')'; })\n\t\t\t\t.attr('class', function(d) { return d.css ? d.css : css; });\n\n\t\t\t// Create the text elements\n\t\t\tcallouts.append('text')\n\t\t\t\t.attr('style', 'text-anchor: left;')\n\t\t\t\t.text(function(d) { return d.label; });\n\n\t\t\t// Create the rectangles behind\n\t\t\tcallouts.insert('rect',':first-child')\n\t\t\t\t.attr('x', function(d) { return -padding - rounded; })\n\t\t\t\t.attr('y', function(d) { \n\t\t\t\t\tcurrentBB = this.parentNode.getBBox();\n\t\t\t\t\tcurrentBB.x = xScale(d.x); \n\t\t\t\t\tcurrentBB.y = yScale(d.y); \n\t\t\t\t\tboundingBoxes.push(currentBB); \n\t\t\t\t\treturn -currentBB.height; \n\t\t\t\t})\n\t\t\t\t.attr('width', function(d) { return currentBB.width + (padding*2) + (rounded*2); })\n\t\t\t\t.attr('height', function(d) { return currentBB.height + (padding*2); })\n\t\t\t\t.attr('rx', rounded)\n\t\t\t\t.attr('ry', rounded);\n\n\t\t\t// Arrange callout\n\t\t\tarrangeCallouts();\n\t\t\tvar index = 0;\n\t\t\tcallouts.attr('transform', function(d) { \n\t\t\t\treturn 'translate(' + boundingBoxes[index].x + ',' + boundingBoxes[index++].y +')';\n\t\t\t});\n\n\t\t\tcallouts = selection.selectAll('g')\n\t\t\t.data(data)\n\t\t\t.exit();\n\t\t};\n\n\t\tcallouts.addCallout = function (value) {\n\t\t    data.push(value);\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.xScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn xScale;\n\t\t\t}\n\t\t\txScale = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.yScale = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn yScale;\n\t\t\t}\n\t\t\tyScale = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.padding = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn padding;\n\t\t\t}\n\t\t\tpadding = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.spacing = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn spacing;\n\t\t\t}\n\t\t\tspacing = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.rounded = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn rounded;\n\t\t\t}\n\t\t\trounded = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.stalkLength = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn stalkLength;\n\t\t\t}\n\t\t\tstalkLength = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.rotationStart = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn rotationStart;\n\t\t\t}\n\t\t\trotationStart = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.rotationSteps = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn rotationSteps;\n\t\t\t}\n\t\t\trotationSteps = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\tcallouts.css = function (value) {\n\t\t\tif (!arguments.length) {\n\t\t\t\treturn css;\n\t\t\t}\n\t\t\tcss = value;\n\t\t\treturn callouts;\n\t\t};\n\n\t\treturn callouts;\n\t};\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\nfc.tools.crosshairs = function () {\n\n    var target = null,\n        series = null,\n        xScale = d3.time.scale(),\n        yScale = d3.scale.linear(),\n        yValue = null,\n        formatH = null,\n        formatV = null,\n        active = true,\n        freezable = true,\n        padding = 2,\n        onSnap = null;\n\n    var lineH = null,\n        lineV = null,\n        circle = null,\n        calloutH = null,\n        calloutV = null;\n\n    var highlight = null,\n        highlightedField = null;\n\n    var crosshairs = function () {\n\n        var root = target.append('g')\n            .attr('class', 'crosshairs');\n\n        lineH = root.append(\"line\")\n            .attr('class', 'crosshairs horizontal')\n            .attr('x1', xScale.range()[0])\n            .attr('x2', xScale.range()[1])\n            .attr('display', 'none');\n\n        lineV = root.append(\"line\")\n            .attr('class', 'crosshairs vertical')\n            .attr('y1', yScale.range()[0])\n            .attr('y2', yScale.range()[1])\n            .attr('display', 'none');\n\n        circle = root.append(\"circle\")\n            .attr('class', 'crosshairs circle')\n            .attr('r', 6)\n            .attr('display', 'none');\n\n        calloutH = root.append(\"text\")\n            .attr('class', 'crosshairs callout horizontal')\n            .attr('x', xScale.range()[1] - padding)\n            .attr('style', 'text-anchor: end')\n            .attr('display', 'none');\n\n        calloutV = root.append(\"text\")\n            .attr('class', 'crosshairs callout vertical')\n            .attr('y', '1em')\n            .attr('style', 'text-anchor: end')\n            .attr('display', 'none');\n    };\n\n    function mousemove() {\n\n        if (active) {\n            crosshairs.update();\n        }\n    }\n\n    function mouseout() {\n\n        if (active) {\n            crosshairs.clear();\n        }\n    }\n\n    function mouseclick() {\n\n        if (freezable) {\n            crosshairs.active(!active);\n        }\n    }\n\n    function findNearest(xTarget) {\n\n        var nearest = null,\n            dx = Number.MAX_VALUE;\n\n        series.forEach(function(data) {\n\n            var xDiff = Math.abs(xTarget.getTime() - data.date.getTime());\n\n            if (xDiff < dx) {\n                dx = xDiff;\n                nearest = data;\n            }\n        });\n\n        return nearest;\n    }\n\n    function findField(yTarget, data) {\n\n        var field = null;\n\n        var minDiff = Number.MAX_VALUE;\n        for (var property in data) {\n            if (data.hasOwnProperty(property) && (property !== 'date')) {\n                var dy = Math.abs(yTarget - data[property]);\n                if (dy <= minDiff) {\n                    minDiff = dy;\n                    field = property;\n                }\n            }\n        }\n\n        return field;\n    }\n\n    function redraw() {\n\n        var x = xScale(highlight.date),\n            y = yScale(highlight[highlightedField]);\n\n        lineH.attr('y1', y)\n            .attr('y2', y);\n        lineV.attr('x1', x)\n            .attr('x2', x);\n        circle.attr('cx', x)\n            .attr('cy', y);\n        calloutH.attr('y', y - padding)\n            .text(formatH(highlight[highlightedField], highlightedField));\n        calloutV.attr('x', x - padding)\n            .text(formatV(highlight.date));\n\n        lineH.attr('display', 'inherit');\n        lineV.attr('display', 'inherit');\n        circle.attr('display', 'inherit');\n        calloutH.attr('display', 'inherit');\n        calloutV.attr('display', 'inherit');\n    }\n\n    crosshairs.update = function() {\n\n        if (!active) {\n\n            redraw();\n\n        } else {\n\n            var mouse = [0, 0];\n            try {\n                mouse = d3.mouse(target[0][0]);\n            }\n            catch (exception) {\n                // Mouse is elsewhere\n            }\n\n            var xMouse = xScale.invert(mouse[0]),\n                yMouse = yScale.invert(mouse[1]),\n                nearest = findNearest(xMouse);\n\n            if (nearest !== null) {\n\n                var field = null;\n                if (nearest[yValue]) {\n                    field = yValue;\n                } else {\n                    field = findField(yMouse, nearest);\n                }\n\n                if ((nearest !== highlight) || (field !== highlightedField)) {\n\n                    highlight = nearest;\n                    highlightedField = field;\n\n                    redraw();\n                    if (onSnap) {\n                        onSnap(highlight);\n                    }\n                }\n            }\n        }\n    };\n\n    crosshairs.clear = function() {\n\n        highlight = null;\n        highlightedField = null;\n\n        lineH.attr('display', 'none');\n        lineV.attr('display', 'none');\n        circle.attr('display', 'none');\n        calloutH.attr('display', 'none');\n        calloutV.attr('display', 'none');\n    };\n\n    crosshairs.target = function (value) {\n        if (!arguments.length) {\n            return target;\n        }\n\n        if (target) {\n\n            target.on('mousemove.crosshairs', null);\n            target.on('mouseout.crosshairs', null);\n            target.on('click.crosshairs', null);\n        }\n\n        target = value;\n\n        target.on('mousemove.crosshairs', mousemove);\n        target.on('mouseout.crosshairs', mouseout);\n        target.on('click.crosshairs', mouseclick);\n\n        return crosshairs;\n    };\n\n    crosshairs.series = function (value) {\n        if (!arguments.length) {\n            return series;\n        }\n        series = value;\n        return crosshairs;\n    };\n\n    crosshairs.xScale = function (value) {\n        if (!arguments.length) {\n            return xScale;\n        }\n        xScale = value;\n        return crosshairs;\n    };\n\n    crosshairs.yScale = function (value) {\n        if (!arguments.length) {\n            return yScale;\n        }\n        yScale = value;\n        return crosshairs;\n    };\n\n    crosshairs.yValue = function (value) {\n        if (!arguments.length) {\n            return yValue;\n        }\n        yValue = value;\n        return crosshairs;\n    };\n\n    crosshairs.formatH = function (value) {\n        if (!arguments.length) {\n            return formatH;\n        }\n        formatH = value;\n        return crosshairs;\n    };\n\n    crosshairs.formatV = function (value) {\n        if (!arguments.length) {\n            return formatV;\n        }\n        formatV = value;\n        return crosshairs;\n    };\n\n    crosshairs.active = function (value) {\n        if (!arguments.length) {\n            return active;\n        }\n        active = value;\n\n        lineH.classed('frozen', !active);\n        lineV.classed('frozen', !active);\n        circle.classed('frozen', !active);\n\n        return crosshairs;\n    };\n\n    crosshairs.freezable = function (value) {\n        if (!arguments.length) {\n            return freezable;\n        }\n        freezable = value;\n        return crosshairs;\n    };\n\n    crosshairs.padding = function (value) {\n        if (!arguments.length) {\n            return padding;\n        }\n        padding = value;\n        return crosshairs;\n    };\n\n    crosshairs.onSnap = function (value) {\n        if (!arguments.length) {\n            return onSnap;\n        }\n        onSnap = value;\n        return crosshairs;\n    };\n\n    crosshairs.highlightedPoint = function() {\n        return highlight;\n    };\n\n    crosshairs.highlightedField = function() {\n        return highlightedField;\n    };\n\n    return crosshairs;\n};\n\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\n    fc.tools.fibonacciFan = function () {\n\n        var target = null,\n            series = null,\n            xScale = d3.time.scale(),\n            yScale = d3.scale.linear(),\n            active = true;\n\n        var circleOrigin = null,\n            circleTarget = null,\n            lineSource = null,\n            lineA = null,\n            lineB = null,\n            lineC = null,\n            fanArea = null;\n\n        var phase = 1,\n            locationOrigin = null,\n            locationTarget = null;\n\n        var fibonacciFan = function () {\n\n            var root = target.append('g')\n                .attr('class', 'fibonacci-fan');\n\n            circleOrigin = root.append(\"circle\")\n                .attr('class', 'fibonacci-fan origin')\n                .attr('r', 6)\n                .attr('display', 'none');\n\n            circleTarget = root.append(\"circle\")\n                .attr('class', 'fibonacci-fan target')\n                .attr('r', 6)\n                .attr('display', 'none');\n\n            lineSource = root.append(\"line\")\n                .attr('class', 'fibonacci-fan source')\n                .attr('display', 'none');\n\n            lineA = root.append(\"line\")\n                .attr('class', 'fibonacci-fan a')\n                .attr('display', 'none');\n\n            lineB = root.append(\"line\")\n                .attr('class', 'fibonacci-fan b')\n                .attr('display', 'none');\n\n            lineC = root.append(\"line\")\n                .attr('class', 'fibonacci-fan c')\n                .attr('display', 'none');\n\n            fanArea = root.append(\"polygon\")\n                .attr('class', 'fibonacci-fan area')\n                .attr('display', 'none');\n        };\n\n        function mousemove() {\n\n            if (!active) {\n                return;\n            }\n\n            switch (phase) {\n                case 1: {\n                    locationOrigin = findLocation();\n                    if (locationOrigin) {\n                        fibonacciFan.update();\n                        circleOrigin.attr('display', 'inherit');\n                    }\n                    break;\n                }\n                case 2: {\n                    locationTarget = findLocation();\n                    if (locationTarget) {\n                        fibonacciFan.update();\n                        circleTarget.attr('display', 'inherit');\n                        lineSource.attr('display', 'inherit');\n                    }\n                    break;\n                }\n                case 3: {\n                    break;\n                }\n            }\n        }\n\n        function mouseclick() {\n\n            if (!active) {\n                return;\n            }\n\n            switch (phase) {\n                case 1: {\n\n                    phase = 2;\n                    break;\n                }\n                case 2: {\n\n                    setFan();\n\n                    phase = 3;\n                    break;\n                }\n                case 3: {\n\n                    clearAll();\n\n                    phase = 1;\n                    break;\n                }\n            }\n        }\n\n        function findLocation() {\n\n            var mouse = [0, 0];\n            try {\n                mouse = d3.mouse(target[0][0]);\n            }\n            catch (exception) {\n                // Mouse is elsewhere\n            }\n\n            var xMouse = xScale.invert(mouse[0]),\n                yMouse = yScale.invert(mouse[1]),\n                point = findPoint(xMouse);\n\n            if (point !== null) {\n\n                var field = findField(yMouse, point);\n\n                if (field !== null) {\n\n                    return { point: point, field: field };\n                }\n            }\n\n            return null;\n        }\n\n        function findPoint(xTarget) {\n\n            var nearest = null,\n                dx = Number.MAX_VALUE;\n\n            series.forEach(function(data) {\n\n                var xDiff = Math.abs(xTarget.getTime() - data.date.getTime());\n\n                if (xDiff < dx) {\n                    dx = xDiff;\n                    nearest = data;\n                }\n            });\n\n            return nearest;\n        }\n\n        function findField(yTarget, data) {\n\n            var field = null;\n\n            var minDiff = Number.MAX_VALUE;\n            for (var property in data) {\n                if (data.hasOwnProperty(property) && (property !== 'date')) {\n                    var dy = Math.abs(yTarget - data[property]);\n                    if (dy <= minDiff) {\n                        minDiff = dy;\n                        field = property;\n                    }\n                }\n            }\n\n            return field;\n        }\n\n        function setFan() {\n\n            if (xScale(locationOrigin.point.date) > xScale(locationTarget.point.date)) {\n                var tmp = locationOrigin;\n                locationOrigin = locationTarget;\n                locationTarget = tmp;\n            }\n\n            var originX = xScale(locationOrigin.point.date),\n                originY = yScale(locationOrigin.point[locationOrigin.field]),\n                targetX = xScale(locationTarget.point.date),\n                targetY = yScale(locationTarget.point[locationTarget.field]),\n                finalX = xScale.range()[1],\n                finalY = calculateY(originX, originY, targetX, targetY, finalX);\n\n            if (finalY) {\n\n                setFanLines(originX, originY, finalX, finalY.source, finalY.source, finalY.source);\n\n                lineA.attr('display', 'inherit');\n                lineB.attr('display', 'inherit');\n                lineC.attr('display', 'inherit');\n                fanArea.attr('display', 'inherit');\n\n                var pointsFinal = originX + ',' + originY +\n                    ' ' + finalX + ',' + finalY.a +\n                    ' ' + finalX + ',' + finalY.c;\n\n                lineA.transition()\n                    .attr('y2', finalY.a);\n                lineB.transition()\n                    .attr('y2', finalY.b);\n                lineC.transition()\n                    .attr('y2', finalY.c);\n                fanArea.transition()\n                    .attr('points', pointsFinal);\n            }\n\n            circleOrigin.attr('display', 'none');\n            circleTarget.attr('display', 'none');\n        }\n\n        function clearAll() {\n\n            locationOrigin = null;\n            locationTarget = null;\n\n            circleOrigin.attr('display', 'none');\n            circleTarget.attr('display', 'none');\n            lineSource.attr('display', 'none');\n            lineA.attr('display', 'none');\n            lineB.attr('display', 'none');\n            lineC.attr('display', 'none');\n            fanArea.attr('display', 'none');\n        }\n\n        function calculateY(originX, originY, targetX, targetY, finalX) {\n\n            if (originX === targetX) { return null; }\n\n            var gradient = (targetY - originY) / (targetX - originX),\n                ySource = (gradient * (finalX - originX)) + originY,\n                yA = ((gradient * 0.618) * (finalX - originX)) + originY,\n                yB = ((gradient * 0.500) * (finalX - originX)) + originY,\n                yC = ((gradient * 0.382) * (finalX - originX)) + originY;\n\n            return {source: ySource, a: yA, b: yB, c: yC};\n        }\n\n        function setFanLines(originX, originY, finalX, finalYa, finalYb, finalYc) {\n\n            var points = originX + ',' + originY +\n                ' ' + finalX + ',' + finalYa +\n                ' ' + finalX + ',' + finalYc;\n\n            lineA.attr('x1', originX)\n                .attr('y1', originY)\n                .attr('x2', finalX)\n                .attr('y2', finalYa);\n            lineB.attr('x1', originX)\n                .attr('y1', originY)\n                .attr('x2', finalX)\n                .attr('y2', finalYb);\n            lineC.attr('x1', originX)\n                .attr('y1', originY)\n                .attr('x2', finalX)\n                .attr('y2', finalYc);\n            fanArea.attr('points', points);\n        }\n\n        fibonacciFan.update = function () {\n\n            if (locationOrigin) {\n\n                var originX = xScale(locationOrigin.point.date),\n                    originY = yScale(locationOrigin.point[locationOrigin.field]);\n\n                circleOrigin.attr('cx', originX)\n                    .attr('cy', originY);\n                lineSource.attr('x1', originX)\n                    .attr('y1', originY);\n\n                if (locationTarget && (phase !== 1)) {\n\n                    var targetX = xScale(locationTarget.point.date),\n                        targetY = yScale(locationTarget.point[locationTarget.field]);\n\n                    circleTarget.attr('cx', targetX)\n                        .attr('cy', targetY);\n                    lineSource.attr('x2', targetX)\n                        .attr('y2', targetY);\n\n                    if (phase === 3) {\n\n                        var finalX = xScale.range()[1],\n                            finalY = calculateY(originX, originY, targetX, targetY, finalX);\n\n                        if (finalY) {\n                            setFanLines(originX, originY, finalX, finalY.a, finalY.b, finalY.c);\n                        }\n                    }\n                }\n            }\n        };\n\n        fibonacciFan.visible = function (value) {\n\n            if (value) {\n\n                switch (phase) {\n                    case 1: {\n                        circleOrigin.attr('display', 'inherit');\n                        break;\n                    }\n                    case 2: {\n                        circleOrigin.attr('display', 'inherit');\n                        circleTarget.attr('display', 'inherit');\n                        lineSource.attr('display', 'inherit');\n                        break;\n                    }\n                    case 3: {\n                        lineSource.attr('display', 'inherit');\n                        lineA.attr('display', 'inherit');\n                        lineB.attr('display', 'inherit');\n                        lineC.attr('display', 'inherit');\n                        fanArea.attr('display', 'inherit');\n                        break;\n                    }\n                }\n            } else {\n\n                circleOrigin.attr('display', 'none');\n                circleTarget.attr('display', 'none');\n                lineSource.attr('display', 'none');\n                lineA.attr('display', 'none');\n                lineB.attr('display', 'none');\n                lineC.attr('display', 'none');\n                fanArea.attr('display', 'none');\n            }\n        };\n\n        fibonacciFan.target = function (value) {\n            if (!arguments.length) {\n                return target;\n            }\n\n            if (target) {\n\n                target.on('mousemove.fibonacci-fan', null);\n                target.on('click.fibonacci-fan', null);\n            }\n\n            target = value;\n\n            target.on('mousemove.fibonacci-fan', mousemove);\n            target.on('click.fibonacci-fan', mouseclick);\n\n            return fibonacciFan;\n        };\n\n        fibonacciFan.series = function (value) {\n            if (!arguments.length) {\n                return series;\n            }\n            series = value;\n            return fibonacciFan;\n        };\n\n        fibonacciFan.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return fibonacciFan;\n        };\n\n        fibonacciFan.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return fibonacciFan;\n        };\n\n        fibonacciFan.active = function (value) {\n            if (!arguments.length) {\n                return active;\n            }\n            active = value;\n            return fibonacciFan;\n        };\n\n        return fibonacciFan;\n    };\n\n}(d3, fc));","(function (d3, fc) {\n    'use strict';\n\n    fc.tools.measure = function () {\n\n        var target = null,\n            series = null,\n            xScale = d3.time.scale(),\n            yScale = d3.scale.linear(),\n            active = true,\n            padding = 2,\n            formatH = null,\n            formatV = null;\n\n        var circleOrigin = null,\n            circleTarget = null,\n            lineSource = null,\n            lineX = null,\n            lineY = null,\n            calloutX = null,\n            calloutY = null;\n\n        var phase = 1,\n            locationOrigin = null,\n            locationTarget = null;\n\n        var measure = function () {\n\n            var root = target.append('g')\n                .attr('class', 'measure');\n\n            circleOrigin = root.append(\"circle\")\n                .attr('class', 'measure origin')\n                .attr('r', 6)\n                .attr('display', 'none');\n\n            circleTarget = root.append(\"circle\")\n                .attr('class', 'measure target')\n                .attr('r', 6)\n                .attr('display', 'none');\n\n            lineSource = root.append(\"line\")\n                .attr('class', 'measure source')\n                .attr('display', 'none');\n\n            lineX = root.append(\"line\")\n                .attr('class', 'measure x')\n                .attr('display', 'none');\n\n            lineY = root.append(\"line\")\n                .attr('class', 'measure y')\n                .attr('display', 'none');\n\n            calloutX = root.append(\"text\")\n                .attr('class', 'measure callout horizontal')\n                .attr('style', 'text-anchor: end')\n                .attr('display', 'none');\n\n            calloutY = root.append(\"text\")\n                .attr('class', 'measure callout vertical')\n                .attr('style', 'text-anchor: middle')\n                .attr('display', 'none');\n        };\n\n        function mousemove() {\n\n            if (!active) {\n                return;\n            }\n\n            switch (phase) {\n                case 1: {\n                    locationOrigin = findLocation();\n                    if (locationOrigin) {\n                        measure.update();\n                        circleOrigin.attr('display', 'inherit');\n                    }\n                    break;\n                }\n                case 2: {\n                    locationTarget = findLocation();\n                    if (locationTarget) {\n                        measure.update();\n                        circleTarget.attr('display', 'inherit');\n                        lineSource.attr('display', 'inherit');\n                    }\n                    break;\n                }\n                case 3: {\n                    break;\n                }\n            }\n        }\n\n        function mouseclick() {\n\n            if (!active) {\n                return;\n            }\n\n            switch (phase) {\n                case 1: {\n\n                    phase = 2;\n                    break;\n                }\n                case 2: {\n\n                    doMeasure();\n\n                    phase = 3;\n                    break;\n                }\n                case 3: {\n\n                    clearAll();\n\n                    phase = 1;\n                    break;\n                }\n            }\n        }\n\n        function findLocation() {\n\n            var mouse = [0, 0];\n            try {\n                mouse = d3.mouse(target[0][0]);\n            }\n            catch (exception) {\n                // Mouse is elsewhere\n            }\n\n            var xMouse = xScale.invert(mouse[0]),\n                yMouse = yScale.invert(mouse[1]),\n                point = findPoint(xMouse);\n\n            if (point !== null) {\n\n                var field = findField(yMouse, point);\n\n                if (field !== null) {\n\n                    return { point: point, field: field };\n                }\n            }\n\n            return null;\n        }\n\n        function findPoint(xTarget) {\n\n            var nearest = null,\n                dx = Number.MAX_VALUE;\n\n            series.forEach(function(data) {\n\n                var xDiff = Math.abs(xTarget.getTime() - data.date.getTime());\n\n                if (xDiff < dx) {\n                    dx = xDiff;\n                    nearest = data;\n                }\n            });\n\n            return nearest;\n        }\n\n        function findField(yTarget, data) {\n\n            var field = null;\n\n            var minDiff = Number.MAX_VALUE;\n            for (var property in data) {\n                if (data.hasOwnProperty(property) && (property !== 'date')) {\n                    var dy = Math.abs(yTarget - data[property]);\n                    if (dy <= minDiff) {\n                        minDiff = dy;\n                        field = property;\n                    }\n                }\n            }\n\n            return field;\n        }\n\n        function doMeasure() {\n\n            var originX = xScale(locationOrigin.point.date),\n                originY = yScale(locationOrigin.point[locationOrigin.field]),\n                targetX = xScale(locationTarget.point.date),\n                targetY = yScale(locationTarget.point[locationTarget.field]);\n\n            lineX.attr('x1', originX)\n                .attr('y1', originY)\n                .attr('x2', targetX)\n                .attr('y2', originY);\n            lineY.attr('x1', targetX)\n                .attr('y1', originY)\n                .attr('x2', targetX)\n                .attr('y2', targetY);\n\n            calloutX.attr('x', targetX - padding)\n                .attr('y', originY - (originY - targetY) / 2.0)\n                .text(formatV(Math.abs(locationTarget.point[locationTarget.field] - locationOrigin.point[locationOrigin.field])));\n            calloutY.attr('y', originY - padding)\n                .attr('x', originX + (targetX - originX) / 2.0)\n                .text(formatH(Math.abs(locationTarget.point.date.getTime() - locationOrigin.point.date.getTime())));\n\n            lineX.attr('display', 'inherit');\n            lineY.attr('display', 'inherit');\n            calloutX.attr('display', 'inherit');\n            calloutY.attr('display', 'inherit');\n\n            circleOrigin.attr('display', 'none');\n            circleTarget.attr('display', 'none');\n        }\n\n        function clearAll() {\n\n            locationOrigin = null;\n            locationTarget = null;\n\n            circleOrigin.attr('display', 'none');\n            circleTarget.attr('display', 'none');\n            lineSource.attr('display', 'none');\n            lineX.attr('display', 'none');\n            lineY.attr('display', 'none');\n            calloutX.attr('display', 'none');\n            calloutY.attr('display', 'none');\n        }\n\n        measure.update = function () {\n\n            if (locationOrigin) {\n\n                var originX = xScale(locationOrigin.point.date),\n                    originY = yScale(locationOrigin.point[locationOrigin.field]);\n\n                circleOrigin.attr('cx', originX)\n                    .attr('cy', originY);\n                lineSource.attr('x1', originX)\n                    .attr('y1', originY);\n\n                if (locationTarget && (phase !== 1)) {\n\n                    var targetX = xScale(locationTarget.point.date),\n                        targetY = yScale(locationTarget.point[locationTarget.field]);\n\n                    circleTarget.attr('cx', targetX)\n                        .attr('cy', targetY);\n                    lineSource.attr('x2', targetX)\n                        .attr('y2', targetY);\n\n                    if (phase === 3) {\n\n                        doMeasure();\n                    }\n                }\n            }\n        };\n\n        measure.visible = function (value) {\n\n            if (value) {\n\n                switch (phase) {\n                    case 1: {\n                        circleOrigin.attr('display', 'inherit');\n                        break;\n                    }\n                    case 2: {\n                        circleOrigin.attr('display', 'inherit');\n                        circleTarget.attr('display', 'inherit');\n                        lineSource.attr('display', 'inherit');\n                        break;\n                    }\n                    case 3: {\n                        lineSource.attr('display', 'inherit');\n                        lineX.attr('display', 'inherit');\n                        lineY.attr('display', 'inherit');\n                        calloutX.attr('display', 'inherit');\n                        calloutY.attr('display', 'inherit');\n                        break;\n                    }\n                }\n            } else {\n\n                circleOrigin.attr('display', 'none');\n                circleTarget.attr('display', 'none');\n                lineSource.attr('display', 'none');\n                lineX.attr('display', 'none');\n                lineY.attr('display', 'none');\n                calloutX.attr('display', 'none');\n                calloutY.attr('display', 'none');\n            }\n        };\n\n        measure.target = function (value) {\n            if (!arguments.length) {\n                return target;\n            }\n\n            if (target) {\n\n                target.on('mousemove.measure', null);\n                target.on('click.measure', null);\n            }\n\n            target = value;\n\n            target.on('mousemove.measure', mousemove);\n            target.on('click.measure', mouseclick);\n\n            return measure;\n        };\n\n        measure.series = function (value) {\n            if (!arguments.length) {\n                return series;\n            }\n            series = value;\n            return measure;\n        };\n\n        measure.xScale = function (value) {\n            if (!arguments.length) {\n                return xScale;\n            }\n            xScale = value;\n            return measure;\n        };\n\n        measure.yScale = function (value) {\n            if (!arguments.length) {\n                return yScale;\n            }\n            yScale = value;\n            return measure;\n        };\n\n        measure.active = function (value) {\n            if (!arguments.length) {\n                return active;\n            }\n            active = value;\n            return measure;\n        };\n\n        measure.padding = function (value) {\n            if (!arguments.length) {\n                return padding;\n            }\n            padding = value;\n            return measure;\n        };\n\n        measure.formatH = function (value) {\n            if (!arguments.length) {\n                return formatH;\n            }\n            formatH = value;\n            return measure;\n        };\n\n        measure.formatV = function (value) {\n            if (!arguments.length) {\n                return formatV;\n            }\n            formatV = value;\n            return measure;\n        };\n\n        return measure;\n    };\n\n}(d3, fc));"]}